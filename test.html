<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
	<title>网络拍卖会</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			background-color: #f2f2f2;
		}
		h1 {
			font-size: 32px;
			margin-bottom: 20px;
			color: #333;
			text-align: center;
			text-shadow: 2px 2px #ccc;
		}
		label {
			display: block;
			margin-bottom: 10px;
			color: #666;
		}
		input {
			padding: 10px;
			border: none;
			border-radius: 4px;
			font-size: 16px;
			width: 100%;
			box-sizing: border-box;
			margin-bottom: 20px;
			background-color: #f9f9f9;
			color: #333;
		}
		button {
			background-color: #4CAF50;
			color: white;
			padding: 10px 20px;
			border: none;
			border-radius: 4px;
			cursor: pointer;
			font-size: 16px;
			transition: background-color 0.3s ease-in-out;
			box-shadow: 2px 2px 5px #888;
		}
		button:hover {
			background-color: #3e8e41;
		}
		#highestBidDisplay {
			font-size: 24px;
			font-weight: bold;
			margin-bottom: 20px;
			color: #333;
			text-shadow: 2px 2px #ccc;
			padding: 10px;
			background-color: #f9f9f9;
			border-radius: 4px;
			box-shadow: 2px 2px 5px #888;
		}
	</style>
</head>
<body>
	<div style="margin: 20%;">
        <h1>网络拍卖会</h1>
        <p>当前最高价格:</p>
        <div id="highestBidDisplay">$0</div>
        <label for="bidInput">输入你想出价的价格:</label>
        <input type="number" id="bidInput">
        <!-- <button onclick="submitBid()" style="margin: 0 auto; display: block;">提交出价</button> -->
		<button onclick="getMaxPrice()" style="margin: 0 auto; display: block;">提交出价</button>
    </div>

	<script>
		// 前端调用后端API获取当前最高价格
		function getMaxPrice() {
			// 替换为实际的后端API URL
			fetch("http://localhost:8080")
			    .then(response => response.json())
                .then(data => log.alert(data));
		}

		// 前端调用后端API发起拍卖请求
		function putMyPrice(price) {
			// 替换为实际的后端API URL
			fetch("http://localhost/put_my_price", {
				method: 'PUT',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify({ price: price })
			})
			.then(response => {
                if (response.ok) {
				// 提交成功，重新获取最高价格并更新显示
				getMaxPrice();
				alert("出价成功！");
			} else {
				// 提交失败，显示错误信息
				alert("出价失败：" + response.statusText);
			}
		})
		.catch(error => console.error(error));
	}

	// 提交出价按钮的点击事件处理程序
	function submitBid() {
		// 获取输入的出价
		let bidInput = document.getElementById("bidInput");
		let bidAmount = parseFloat(bidInput.value);
		if (isNaN(bidAmount)) {
			alert("请输入有效的数字！");
			return;
		}
		// 获取当前最高价格
		let highestBid = parseFloat(document.getElementById("highestBidDisplay").innerHTML.substr(1));
		// 判断出价是否高于当前最高价格
		if (bidAmount > highestBid) {
			// 发起拍卖请求
			putMyPrice(bidAmount);
		} else {
			alert("您的出价必须高于当前最高价格！");
		}
		// 清空输入框
		bidInput.value = "";
	}

	// 页面加载时获取最高价格并显示
	getMaxPrice();
</script>
</body>
</html>
